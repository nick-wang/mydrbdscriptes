drbd-sp2-autotest-1: test -d /usr/share/drbd-test
drbd-sp2-autotest-1: timeout 30
drbd-sp2-autotest-1: export 'PATH=/usr/share/drbd-test:$PATH'
drbd-sp2-autotest-1: export DRBD_TEST_DATA=/usr/share/drbd-test DRBD_TEST_JOB=resize.KNOWN-20160831-114025 EXXE_IDENT=exxe/resize.KNOWN-20160831-114025 DRBD_TEST_VERBOSE=0 'DRBD_TEST_DRBDADM_OPTIONS=-c /var/lib/drbd-test/resize.KNOWN-20160831-114025/drbd.conf'
drbd-sp2-autotest-1: hostname -f
drbd-sp2-autotest-1: drbd-version
drbd-sp2-autotest-1: install-config
drbd-sp2-autotest-1: bash -c 'iptables -N drbd-test-input && iptables -A INPUT -j drbd-test-input || true'
drbd-sp2-autotest-1: iptables: Chain already exists.
drbd-sp2-autotest-1: bash -c 'iptables -N drbd-test-output && iptables -A OUTPUT -j drbd-test-output || true'
drbd-sp2-autotest-1: iptables: Chain already exists.
drbd-sp2-autotest-2: test -d /usr/share/drbd-test
drbd-sp2-autotest-2: timeout 30
drbd-sp2-autotest-2: export 'PATH=/usr/share/drbd-test:$PATH'
drbd-sp2-autotest-2: export DRBD_TEST_DATA=/usr/share/drbd-test DRBD_TEST_JOB=resize.KNOWN-20160831-114025 EXXE_IDENT=exxe/resize.KNOWN-20160831-114025 DRBD_TEST_VERBOSE=0 'DRBD_TEST_DRBDADM_OPTIONS=-c /var/lib/drbd-test/resize.KNOWN-20160831-114025/drbd.conf'
drbd-sp2-autotest-2: hostname -f
drbd-sp2-autotest-2: drbd-version
drbd-sp2-autotest-2: install-config
drbd-sp2-autotest-2: bash -c 'iptables -N drbd-test-input && iptables -A INPUT -j drbd-test-input || true'
drbd-sp2-autotest-2: iptables: Chain already exists.
drbd-sp2-autotest-2: bash -c 'iptables -N drbd-test-output && iptables -A OUTPUT -j drbd-test-output || true'
drbd-sp2-autotest-2: iptables: Chain already exists.
drbd-sp2-autotest-1 drbd-sp2-autotest-2: rsyslogd drbd-sp2-autotest-1 5140
drbd-sp2-autotest-1 drbd-sp2-autotest-2: disable-faults
drbd-sp2-autotest-1 drbd-sp2-autotest-2: register-cleanup -t bash -c '! [ -e /proc/drbd ] || drbdsetup down $DRBD_TEST_JOB'
drbd-sp2-autotest-1: create-disk --internal-meta --max-peers 1 --job resize.KNOWN-20160831-114025 --volume-group scratch --size 8M resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-2: create-disk --internal-meta --max-peers 1 --job resize.KNOWN-20160831-114025 --volume-group scratch --size 8M resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-1: install-config
drbd-sp2-autotest-2: install-config
drbd-sp2-autotest-1 drbd-sp2-autotest-2: drbdadm up all -v
drbd-sp2-autotest-1: drbdsetup new-resource resize.KNOWN-20160831-114025 0 
drbd-sp2-autotest-1: drbdsetup new-minor resize.KNOWN-20160831-114025 138 0 
drbd-sp2-autotest-1: drbdmeta 138 v09 /dev/scratch/resize.KNOWN-20160831-114025-disk0 internal apply-al 
drbd-sp2-autotest-1: drbdsetup attach 138 /dev/scratch/resize.KNOWN-20160831-114025-disk0 /dev/scratch/resize.KNOWN-20160831-114025-disk0 internal --md-flushes=no --disk-flushes=no 
drbd-sp2-autotest-1: drbdsetup new-peer resize.KNOWN-20160831-114025 1 --_name=drbd-sp2-autotest-2 
drbd-sp2-autotest-1: drbdsetup new-path resize.KNOWN-20160831-114025 1 ipv4:192.168.122.23:7789 ipv4:192.168.122.27:7789 
drbd-sp2-autotest-1: drbdsetup connect resize.KNOWN-20160831-114025 1 
drbd-sp2-autotest-2: drbdsetup new-resource resize.KNOWN-20160831-114025 1 
drbd-sp2-autotest-2: drbdsetup new-minor resize.KNOWN-20160831-114025 138 0 
drbd-sp2-autotest-2: drbdmeta 138 v09 /dev/scratch/resize.KNOWN-20160831-114025-disk0 internal apply-al 
drbd-sp2-autotest-2: drbdsetup attach 138 /dev/scratch/resize.KNOWN-20160831-114025-disk0 /dev/scratch/resize.KNOWN-20160831-114025-disk0 internal --md-flushes=no --disk-flushes=no 
drbd-sp2-autotest-2: drbdsetup new-peer resize.KNOWN-20160831-114025 0 --_name=drbd-sp2-autotest-1 
drbd-sp2-autotest-2: drbdsetup new-path resize.KNOWN-20160831-114025 0 ipv4:192.168.122.27:7789 ipv4:192.168.122.23:7789 
drbd-sp2-autotest-2: drbdsetup connect resize.KNOWN-20160831-114025 0 
Waiting for event drbd-sp2-autotest-1:drbd-sp2-autotest-2:0 drbd-sp2-autotest-2:drbd-sp2-autotest-1:0 -y peer-device .* peer-disk:(Inconsistent|Diskless)

* Initial sync
drbd-sp2-autotest-1: drbdadm primary --force all -v
drbd-sp2-autotest-1: drbdsetup primary resize.KNOWN-20160831-114025 --force 
Waiting for event drbd-sp2-autotest-1 -y resource .* role:Primary

Waiting for event drbd-sp2-autotest-1:0 -y device .* disk:UpToDate

drbd-sp2-autotest-1: drbdadm secondary all
Waiting for event drbd-sp2-autotest-1 -y resource .* role:Secondary

drbd-sp2-autotest-1: fio --section write -
* Loop with Primary node
* Node drbd-sp2-autotest-1 wants to use 16MB; primary==True.
drbd-sp2-autotest-1: lvresize -L 16M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-1:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 8.00 MiB (2 extents) to 16.00 MiB (4 extents).
drbd-sp2-autotest-1:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: lvresize -L 16M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-2:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 8.00 MiB (2 extents) to 16.00 MiB (4 extents).
drbd-sp2-autotest-2:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-1: drbdadm primary all -v
drbd-sp2-autotest-1: drbdsetup primary resize.KNOWN-20160831-114025 
Waiting for event drbd-sp2-autotest-1 -y resource .* role:Primary

drbd-sp2-autotest-1: drbdadm resize resize.KNOWN-20160831-114025
drbd-sp2-autotest-1: drbdadm secondary all
Waiting for event drbd-sp2-autotest-1 -y resource .* role:Secondary

drbd-sp2-autotest-1: fio --section write -
drbd-sp2-autotest-1: blockdev --getsize64 /dev/drbd138
* Node drbd-sp2-autotest-1 got 16.0MB.
* Node drbd-sp2-autotest-2 wants to use 24MB; primary==True.
drbd-sp2-autotest-1: lvresize -L 24M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-1:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 16.00 MiB (4 extents) to 24.00 MiB (6 extents).
drbd-sp2-autotest-1:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: lvresize -L 24M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-2:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 16.00 MiB (4 extents) to 24.00 MiB (6 extents).
drbd-sp2-autotest-2:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: drbdadm primary all -v
drbd-sp2-autotest-2: drbdsetup primary resize.KNOWN-20160831-114025 
Waiting for event drbd-sp2-autotest-2 -y resource .* role:Primary

drbd-sp2-autotest-2: drbdadm resize resize.KNOWN-20160831-114025
drbd-sp2-autotest-2: drbdadm secondary all
Waiting for event drbd-sp2-autotest-2 -y resource .* role:Secondary

drbd-sp2-autotest-2: fio --section write -
drbd-sp2-autotest-2: blockdev --getsize64 /dev/drbd138
* Node drbd-sp2-autotest-2 got 24.0MB.
* Loop with secondaries
* Node drbd-sp2-autotest-1 wants to use 32MB; primary==False.
drbd-sp2-autotest-1: lvresize -L 32M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-1:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 24.00 MiB (6 extents) to 32.00 MiB (8 extents).
drbd-sp2-autotest-1:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: lvresize -L 32M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-2:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 24.00 MiB (6 extents) to 32.00 MiB (8 extents).
drbd-sp2-autotest-2:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-1: drbdadm resize resize.KNOWN-20160831-114025
drbd-sp2-autotest-1: fio --section write -
drbd-sp2-autotest-1: blockdev --getsize64 /dev/drbd138
* Node drbd-sp2-autotest-1 got 32.0MB.
* Node drbd-sp2-autotest-2 wants to use 40MB; primary==False.
drbd-sp2-autotest-1: lvresize -L 40M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-1:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 32.00 MiB (8 extents) to 40.00 MiB (10 extents).
drbd-sp2-autotest-1:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: lvresize -L 40M scratch/resize.KNOWN-20160831-114025-disk0
drbd-sp2-autotest-2:   Size of logical volume scratch/resize.KNOWN-20160831-114025-disk0 changed from 32.00 MiB (8 extents) to 40.00 MiB (10 extents).
drbd-sp2-autotest-2:   Logical volume resize.KNOWN-20160831-114025-disk0 successfully resized
drbd-sp2-autotest-2: drbdadm resize resize.KNOWN-20160831-114025
drbd-sp2-autotest-2: fio --section write -
drbd-sp2-autotest-2: blockdev --getsize64 /dev/drbd138
* Node drbd-sp2-autotest-2 got 40.0MB.
drbd-sp2-autotest-1 drbd-sp2-autotest-2: cleanup
drbd-sp2-autotest-1:   drbd-sp2-autotest-1: Logical volume scratch/resize.KNOWN-20160831-114025-disk0 is used by another device.drbd-sp2-autotest-1: 

drbd-sp2-autotest-1: cleanup failed with status 1drbd-sp2-autotest-2:   Logical volume scratch/resize.KNOWN-20160831-114025-disk0 is used by another device.
drbd-sp2-autotest-2: cleanup failed with status 1